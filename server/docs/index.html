<!DOCTYPE html>
<html>

<head>
    <title>SharErasmus</title>
    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/style_Enzo.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>

<body>

    <header>
        <div class="form-row">
            <div class="col-7">
                <a href="home.html"><img src="./img/logo200.png" height="120" width="120"></a>
            </div>
            <div class="col align-self-end">
                <!-- FORM LOGIN-->

                <div class="form-row">
                    <div class="form col-4">
                        <label for="staticEmail2" class="sr-only">Email</label>
                        <input type="text" class="form-control" id="idemail" name="email" placeholder="email@example.com"
                            pattern="[a-zA-Z0-9\._-]+[@][a-zA-Z0-9\._-]+[.][a-zA-Z]+">

                    </div>
                    <div class="form col-4">
                        <label for="inputPassword2" class="sr-only">Password</label>
                        <input type="password" class="form-control" id="idpassword" name="password" placeholder="Password"
                            pattern="[A-Z0-9a-z.!@_-]{8,16}">

                    </div>
                    <div class="form col-2">
                        <button type="button" class="btn btn-primary mb-2" id="login">Login</button>
                    </div>
                </div>
                <div class="form-row">

                    <div class="form col-4">
                        
                    </div>
                    <div class="col">
                        <small><a href="./recupero_psw.html" style="color:white">Non ricordi piu come accedere
                                all'account?</a></small>
                    </div>
                </div>


            </div>
    </header>
    <div style="padding-right: 10px">
        <div class="form-row">
            <div class="col">
                <blockquote class="blockquote text-center">
                    <h1>Accedi al Forum</h1>
                    <img src="img/forum.png" height="375" width="600">
            </div>
            <div class="col">
                    <blockquote class='blockquote text-center'>
                            <h1>Iscriviti</h1>
                    </blockquote>
                    <div class="form-row">
                            <div class="form-group col-3"></div>
                            <div class="form-group col-3">
                                    <h6><input name="user" type="radio" id="student" style="margin-right: 5px;">Studente</h6>
                            </div>
                            <div class="form-group col-4">
                                    <h6><input name="user" type="radio" id="coordinator" style="margin-right: 5px;">Coordinatore</h6>
                            </div>
                        </div>
                <div id="daModificare">
                </div>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>

    <script>

        $(document).on('click', '#student', function () {
            $("#daModificare").html("<form>"+
                "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col-5'>"+
                                "<label for='staticName' class='sr-only'>Nome</label>"+
                                "<input type='text' class='form-control' id='idnome1' name='nome' placeholder='Nome' pattern='\\w+'>"+
                            "</div>"+
                            "<div class='form-group col-5'>"+
                                "<label for='staticSurname' class='sr-only'>Cognome</label>"+
                                "<input type='text' class='form-control' id='idcognome1' name='cognome' placeholder='Cognome' pattern='\\w+'>"+
                            "</div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col-10'>"+
                                "<label for='staticEmail' class='sr-only'>Email</label>"+
                                "<input type='text' class='form-control' id='idemail1' name='email' placeholder='Email' pattern='[a-zA-Z0-9\\._-]+[@][a-zA-Z0-9\\._-]+[.][a-zA-Z]+'>"+
                            "</div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col-10'>"+
                                "<label for='inputPassword' class='sr-only'>Password</label>"+
                                "<input type='password' class='form-control' id='idpassword1' name='password' placeholder='Password' pattern='[A-Z0-9a-z.!@_-]{8,16}'>"+
                            "</div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                           " <div class='form-group col-1'></div>"+
                            "<div class='form-group col-md-4'>"+
                                "<label for='staticCodiceFiscale' class='sr-only'>CodiceFiscale</label>"+
                                "<input type='text' class='form-control' id='idcodicefiscale1' name='codiceFiscale' placeholder='CodiceFiscale' pattern='^[A-Z]{6}\\d{2}[A-Z]\\d{2}[A-Z]\\d{3}[A-Z]$'>"+
                            "</div>"+
                            "<div class='form-group col-md-3'>"+
                                "<label for='staticVia' class='sr-only'>Via</label>"+
                                "<input type='text' class='form-control' id='idvia1' name='via' placeholder='Via' pattern='(\\w+(\\W+)?)+'>"+
                            "</div>"+
                            "<div class='form-group col-md-3'>"+
                                "<label for='staticRecapito' class='sr-only'>Recapito</label>"+
                                "<input type='text' class='form-control' id='idrecapito1' name='recapito' placeholder='Recapito' pattern='\\+?(\\d+){0,12}'>"+
                           " </div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col-5'>"+
                                "<label for='staticMatricola' class='sr-only'>Matricola</label>"+
                                "<input type='text' class='form-control' id='idmatricola1' name='matricola' placeholder='Matricola' pattern='(\\d+){10}'>"+
                            "</div>"+
                            "<div class='form-group col-5'>"+
                                "<label for='staticFacoltà' class='sr-only'>Facoltà</label>"+
                                "<input type='text' class='form-control' id='idfacolta1' name='facolta' placeholder='Dipartimento' pattern='(\\w+|\\W+){0,30}'>"+
                            "</div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col-10'>"+
                                "<small id='passwordHelpInline' class='text-muted'>"+
                                "Cliccando su Registrati, accetti le nostre Condizioni. Scopri in che modo raccogliamo, usiamo e condividiamo i tuoi dati nella nostra Normativa sui dati e in che modo usiamo cookie e tecnologie simili nella nostra Normativa sui cookie. Potresti ricevere notifiche tramite Email da noi, ma puoi disattivarle in qualsiasi momento."+
                                "</small>"+
                            "</div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col'>"+
                                "<button type='button' class='btn btn-primary' id='registrati1'>Registrati</button>"+
                            "</div>"+
                        "</div>"+
                    "</form>")
                    $("#registrati1").click(function(){
            let credenziali ={
                email: $("#idemail1").val(),
                password: $("#idpassword1").val(),
                nome: $("#idnome1").val(),
                cognome: $("#idcognome1").val(),
                codiceFiscale: $("#idcodicefiscale1").val(),
                via: $("#idvia1").val(),
                recapito: $("#idrecapito1").val(),
                ruolo: $("#idruolo1").val(),
                matricola: $("#idmatricola1").val(),
                facolta: $("#idfacolta1").val()
            };
            $.ajax({
                method: 'POST',
                data: credenziali,
                url: 'user/registrazione/',
                success: function(done){
                    alert("Utente registrato");
                    if (done.emailStudente!= undefined && done.emailStudente.includes('@studenti.unisa.it')) {
                        
                        window.location.href = "/index.html";
                    }else {
                        if(done.emailCoordinatore!= undefined)
                        window.location.href = "/index.html";
                    }
                },
                error: function(e){
                    alert("Registrazione non effettuata!"+ JSON.stringify(e));
                    window.location.href = "/index.html";
                }
            })

        })
        })
        $(document).on('click', '#coordinator', function () {
            $("#daModificare").html("<form>"+
                "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col-5'>"+
                                "<label for='staticName' class='sr-only'>Nome</label>"+
                                "<input type='text' class='form-control' id='idnome2' name='nome' placeholder='Nome' pattern='\\w+'>"+
                            "</div>"+
                            "<div class='form-group col-5'>"+
                                "<label for='staticSurname' class='sr-only'>Cognome</label>"+
                                "<input type='text' class='form-control' id='idcognome2' name='cognome' placeholder='Cognome' pattern='\\w+'>"+
                            "</div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col-10'>"+
                                "<label for='staticEmail' class='sr-only'>Email</label>"+
                                "<input type='text' class='form-control' id='idemail2' name='email' placeholder='Email' pattern='[a-zA-Z0-9\\._-]+[@][a-zA-Z0-9\\._-]+[.][a-zA-Z]+'>"+
                            "</div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col-10'>"+
                                "<label for='inputPassword' class='sr-only'>Password</label>"+
                                "<input type='password' class='form-control' id='idpassword2' name='password' placeholder='Password' pattern='[A-Z0-9a-z.!@_-]{8,16}'>"+
                            "</div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                           " <div class='form-group col-1'></div>"+
                            "<div class='form-group col-md-4'>"+
                                "<label for='staticCodiceFiscale' class='sr-only'>CodiceFiscale</label>"+
                                "<input type='text' class='form-control' id='idcodicefiscale2' name='codiceFiscale' placeholder='CodiceFiscale' pattern='^[A-Z]{6}\\d{2}[A-Z]\\d{2}[A-Z]\\d{3}[A-Z]$'>"+
                            "</div>"+
                            "<div class='form-group col-md-3'>"+
                                "<label for='staticVia' class='sr-only'>Via</label>"+
                                "<input type='text' class='form-control' id='idvia2' name='via' placeholder='Via' pattern='(\\w+(\\W+)?)+'>"+
                            "</div>"+
                            "<div class='form-group col-md-3'>"+
                                "<label for='staticRecapito' class='sr-only'>Recapito</label>"+
                                "<input type='text' class='form-control' id='idrecapito2' name='recapito' placeholder='Recapito' pattern='\\+?(\\d+){0,12}'>"+
                           " </div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col-5'>"+
                                "<label for='staticMatricola' class='sr-only'>Ruolo</label>"+
                                "<input type='text' class='form-control' id='idruolo2' name='ruolo' placeholder='Ruolo'>"+
                            "</div>"+
                            "<div class='form-group col-5'>"+
                                "<label for='staticFacoltà' class='sr-only'>Facoltà</label>"+
                                "<input type='text' class='form-control' id='idfacolta2' name='facolta' placeholder='Dipartimento' pattern='(\\w+|\\W+){0,30}'>"+
                            "</div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col-10'>"+
                                "<small id='passwordHelpInline' class='text-muted'>"+
                                "Cliccando su Registrati, accetti le nostre Condizioni. Scopri in che modo raccogliamo, usiamo e condividiamo i tuoi dati nella nostra Normativa sui dati e in che modo usiamo cookie e tecnologie simili nella nostra Normativa sui cookie. Potresti ricevere notifiche tramite Email da noi, ma puoi disattivarle in qualsiasi momento."+
                                "</small>"+
                            "</div>"+
                        "</div>"+
                        "<div class='form-row'>"+
                            "<div class='form-group col-1'></div>"+
                            "<div class='form-group col'>"+
                                "<button type='button' class='btn btn-primary' id='registrati2'>Registrati</button>"+
                            "</div>"+
                        "</div>"+
                        "</form>")
            
        $("#registrati2").click(function(){
            let credenziali ={
                email: $("#idemail2").val(),
                password: $("#idpassword2").val(),
                nome: $("#idnome2").val(),
                cognome: $("#idcognome2").val(),
                codiceFiscale: $("#idcodicefiscale2").val(),
                via: $("#idvia2").val(),
                recapito: $("#idrecapito2").val(),
                ruolo: $("#idruolo2").val(),
                matricola: $("#idmatricola2").val(),
                facolta: $("#idfacolta2").val()
            };
            $.ajax({
                method: 'POST',
                data: credenziali,
                url: 'user/registrazione/',
                success: function(done){
                    alert("Utente registrato");
                    if (done.emailStudente!= undefined && done.emailStudente.includes('@studenti.unisa.it')) {
                        
                        window.location.href = "/index.html";
                    }else {
                        if(done.emailCoordinatore!= undefined)
                        window.location.href = "/index.html";
                    }
                },
                error: function(){
                    alert("Registrazione non effettuata!");
                    window.location.href = "/index.html";
                }
            })

        })
    })
        $("#login").click(function () {
            let credenziali = {
                email: $("#idemail").val(),
                password: $("#idpassword").val()
            };
            $.ajax({
                method: 'POST',
                data: credenziali,
                url: 'user/login/',
                success: function (done) {
                    if (done.emailStudente!= undefined && done.emailStudente.includes('@studenti.unisa.it')) {
                        localStorage.setItem("email", done.emailStudente);
                        window.location.href = "/profil_users.html";
                    } else {
                        if(done.emailCoordinatore!= undefined)
                        localStorage.setItem("email", done.emailCoordinatore);

                        window.location.href = "/profil_users.html";
                    }
                },
                error: function () {
                    alert("Email o password errata");
                },
            });
        })
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
</body>

</html>