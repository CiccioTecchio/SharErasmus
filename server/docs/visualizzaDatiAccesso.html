<!DOCTYPE html>

<!--<header>
    <div class="form-row">
        <div class="col-9">
            <a href="#"><img src="img/logo200.png" class="logo" height="120" width="120"></a>
        </div>

        <div class="col align-self-center">
            <div class="form-row align-self-center">
                <div class="col-2">
                    <img src="img/logo200.png" class="logo" height="40" width="40" style="padding-right:0px; padding-bottom: 0px">
                </div>
                <div class="form-row align-self-center">
                    <p style="padding-top:5px">Nome Utente</p>
                    <span style="padding-left: 20px; padding-top: 10px" class=" fa fa-angle-down"></span>
                </div>
            </div>
        </div>
    </div>
</header>-->
<html>

<head>
    <title>Dati personali</title>

    <link rel="stylesheet" type="text/css" href="css/style_Francesco.css">
    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/custom.min.css">
    <link rel="stylesheet" type="text/css" href="css/style_Enzo.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
        $(function () {
            $("#includedContent").load("top_bar.html");
        });

    </script>
</head>

<body onload="fill()">

    <div id="includedContent"></div>

    <div style="padding-right: 10px">


        <div class="form-row" style="margin-top: 10px">
            <div class="col-2" style="text-align: center">
                <button class="btn btn-success btn-xs" onclick="location.href='./profil_users.html';" style="
                padding-top: 0px;
                padding-bottom: 0px;
                padding-right: 10px;
                padding-left: 10px;
                margin-top: 1px;
            ">
                    Torna indietro</button>
            </div>
            <div class="col-md-8 col-sm-8 col-xs-12" style="padding-left: 10px">
                <div class="x_panel">
                    <div class="x_title" style="margin-bottom:0px">
                        <h2>Dati personali</h2>
                        <div class="clearfix"></div>
                    </div>

                    <table class="table table-hover" style="margin-bottom: 0px">
                        <tbody>
                            <tr>
                                <th scope="col">Nome</th>
                                <td colspan="2" style="width: 274px" id="nome"></td>
                                <td><a href="" data-toggle="modal" data-target="#exampleModalCenter1"><small>modifica</small></a></td>
                            </tr>
                            <tr>
                                <th scope="col">Cognome</th>
                                <td colspan="2" id="cognome"></td>
                                <td><a href="" data-toggle="modal" data-target="#exampleModalCenter2"><small>modifica</small></a></td>
                            </tr>
                            <tr>
                                <th scope="col">Email</th>
                                <td colspan="3" id="email"></td>
                            </tr>
                            <tr>
                                <th scope="col">Password</th>
                                <td colspan="2" id="password"></td>
                                <td><a href="" data-toggle="modal" data-target="#exampleModalCenter3"><small>modifica</small></a></td>
                            </tr>
                            <tr>
                                <th scope="col">Codice fiscale</th>
                                <td colspan="2" id="codicefiscale"></td>
                                <td><a href="" data-toggle="modal" data-target="#exampleModalCenter4"><small>modifica</small></a></td>
                            </tr>
                            <tr>
                                <th scope="col">Via</th>
                                <td colspan="2" id="via"></td>
                                <td><a href="" data-toggle="modal" data-target="#exampleModalCenter5"><small>modifica</small></a></td>
                            </tr>
                            <tr>
                                <th scope="col">Recapito</th>
                                <td colspan="2" id="recapito"></td>
                                <td><a href="" data-toggle="modal" data-target="#exampleModalCenter6"><small>modifica</small></a></td>
                            </tr>
                            <tr>
                                <th scope="col">Dipartimento</th>
                                <td colspan="2" id="facolta"></td>
                                <td><a href="" data-toggle="modal" data-target="#exampleModalCenter7"><small>modifica</small></a></td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="modal-footer" style="padding-bottom: 0px">
                        <input type="hidden" id="hide" name="email">
                        <button type="button" class="btn btn-success btn-sm" id="salva">Salva</button>
                    </div>

                    <!-- Modal nome -->
                    <div class="modal fade nome" id="exampleModalCenter1" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
                        aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div2 class="x_title">
                                    <h2>Modifica nome</h2>
                                    <ul class="nav navbar-right panel_toolbox">
                                        <li><a data-dismiss="modal" aria-label="Close"><i class="fa fa-close"></i></a>
                                        </li>
                                    </ul>
                                </div2>
                                <form>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Nome: </h6>
                                        <div4 class="col-sm-7">
                                            <h6 id="nomeM" style="margin-bottom: 0px; margin-top: 6px"></h6>
                                        </div4>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Nuovo nome: </h6>
                                        <div3 class="col-sm-7">
                                            <input type="text" class="input" id="nomeL" name="nome" placeholder="Inserisci nuovo nome">
                                        </div3>
                                    </div>

                                    <div class="modal-footer">
                                        <input type="hidden" id="hide" name="email">
                                        <button type="button" class="btn btn-primary btn-sm" id="conferma1"
                                            data-dismiss="modal">Conferma</button>
                                        <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Annulla</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="exampleModalCenter2" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
                        aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div2 class="x_title">
                                    <h2>Modifica cognome</h2>
                                    <ul class="nav navbar-right panel_toolbox">
                                        <li><a data-dismiss="modal" aria-label="Close"><i class="fa fa-close"></i></a>
                                        </li>
                                    </ul>
                                </div2>
                                <form>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Cognome:</h6>
                                        <div4 class="col-sm-7">
                                            <h6 id="cognomeM" style="margin-bottom: 0px; margin-top: 6px"></h6>
                                        </div4>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Nuovo cognome: </h6>
                                        <div3 class="col-sm-7">
                                            <input type="text" class="input" id="cognomeL" name="cognome" placeholder="Inserisci nuovo cognome">
                                        </div3>
                                    </div>
                                </form>
                                <div class="modal-footer">
                                    <input type="hidden" id="hide" name="email">
                                    <button type="button" class="btn btn-primary btn-sm" id="conferma2" data-dismiss="modal">Conferma</button>
                                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Annulla</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="exampleModalCenter3" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
                        aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div2 class="x_title">
                                    <h2>Modifica password</h2>
                                    <ul class="nav navbar-right panel_toolbox">
                                        <li><a data-dismiss="modal" aria-label="Close"><i class="fa fa-close"></i></a>
                                        </li>
                                    </ul>
                                </div2>
                                <form>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Password:</h6>
                                        <div4 class="col-sm-7">
                                            <h6 id="pswM" style="margin-bottom: 0px; margin-top: 6px"></h6>
                                        </div4>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Nuova psw: </h6>
                                        <div3 class="col-sm-7">
                                            <input type="text" class="input" id="passwordL" name="passwprd" placeholder="Inserisci nuovo cognome">
                                        </div3>
                                    </div>
                                </form>
                                <div class="modal-footer">
                                    <input type="hidden" id="hide" name="email">
                                    <button type="button" class="btn btn-primary btn-sm" id="conferma3" data-dismiss="modal">Conferma</button>
                                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Annulla</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="exampleModalCenter4" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
                        aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div2 class="x_title">
                                    <h2>Modifica Codice Fiscale</h2>
                                    <ul class="nav navbar-right panel_toolbox">
                                        <li><a data-dismiss="modal" aria-label="Close"><i class="fa fa-close"></i></a>
                                        </li>
                                    </ul>
                                </div2>
                                <form>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Codice Fiscale:</h6>
                                        <div4 class="col-sm-7">
                                            <h6 id="codiceM" style="margin-bottom: 0px; margin-top: 6px"></h6>
                                        </div4>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Nuovo cf: </h6>
                                        <div3 class="col-sm-7">
                                            <input type="text" class="input" id="codicefiscaleL" name="codicefiscale"
                                                placeholder="Inserisci nuovo cognome">
                                        </div3>
                                    </div>
                                </form>
                                <div class="modal-footer">
                                    <input type="hidden" id="hide" name="email">
                                    <button type="button" class="btn btn-primary btn-sm" id="conferma4" data-dismiss="modal">Conferma</button>
                                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Annulla</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="exampleModalCenter5" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
                        aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div2 class="x_title">
                                    <h2>Modifica via</h2>
                                    <ul class="nav navbar-right panel_toolbox">
                                        <li><a data-dismiss="modal" aria-label="Close"><i class="fa fa-close"></i></a>
                                        </li>
                                    </ul>
                                </div2>
                                <form>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Via:</h6>
                                        <div4 class="col-sm-7">
                                            <h6 id="viaM" style="margin-bottom: 0px; margin-top: 6px"></h6>
                                        </div4>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Nuova via: </h6>
                                        <div3 class="col-sm-7">
                                            <input type="text" class="input" id="viaL" name="via" placeholder="Inserisci nuovo cognome">
                                        </div3>
                                    </div>
                                </form>
                                <div class="modal-footer">
                                    <input type="hidden" id="hide" name="email">
                                    <button type="button" class="btn btn-primary btn-sm" id="conferma5" data-dismiss="modal">Conferma</button>
                                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Annulla</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="exampleModalCenter6" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
                        aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div2 class="x_title">
                                    <h2>Modifica recapito</h2>
                                    <ul class="nav navbar-right panel_toolbox">
                                        <li><a data-dismiss="modal" aria-label="Close"><i class="fa fa-close"></i></a>
                                        </li>
                                    </ul>
                                </div2>
                                <form>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Recapito:</h6>
                                        <div4 class="col-sm-7">
                                            <h6 id="recapitoM" style="margin-bottom: 0px; margin-top: 6px"></h6>
                                        </div4>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Nuovo recapito: </h6>
                                        <div3 class="col-sm-7">
                                            <input type="text" class="input" id="recapitoL" name="recapito" placeholder="Inserisci nuovo cognome">
                                        </div3>
                                    </div>
                                </form>
                                <div class="modal-footer">
                                    <input type="hidden" id="hide" name="email">
                                    <button type="button" class="btn btn-primary btn-sm" id="conferma6" data-dismiss="modal">Conferma</button>
                                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Annulla</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal fade" id="exampleModalCenter7" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
                        aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div2 class="x_title">
                                    <h2>Modifica dipartimento</h2>
                                    <ul class="nav navbar-right panel_toolbox">
                                        <li><a data-dismiss="modal" aria-label="Close"><i class="fa fa-close"></i></a>
                                        </li>
                                    </ul>
                                </div2>
                                <form>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Dipartimento:</h6>
                                        <div4 class="col-sm-7">
                                            <h6 id="facoltaM" style="margin-bottom: 0px; margin-top: 6px"></h6>
                                        </div4>
                                    </div>
                                    <div class="form-row">
                                        <div class="col-1"></div>
                                        <h6 class="col-sm-3 font-weight-bold">Nuova dipartimento: </h6>
                                        <div3 class="col-sm-7">
                                            <input type="text" class="input" id="facoltaL" name="facolta" placeholder="Inserisci nuovo cognome">
                                        </div3>
                                    </div>
                                </form>
                                <div class="modal-footer">
                                    <input type="hidden" id="hide" name="email">
                                    <button type="button" class="btn btn-primary btn-sm" id="conferma7" data-dismiss="modal">Conferma</button>
                                    <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Annulla</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>


</body>


<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>

<script>
    /*$(document).ready(function () {
        var x = localStorage.getItem("email");
        var help = document.getElementById("hide")
        help.value = x;
    })
    */
    function fill() {
        var x = localStorage.getItem("email");
        if (x != undefined && x.includes('@studenti.unisa.it')) {
            $.get("/user/visualizzaDA?email=" + x, function (data) {
                $("#nome").text(data.nome);
                $("#cognome").text(data.cognome);
                $("#email").text(data.emailStudente);
                $("#password").text(data.password);
                $("#codicefiscale").text(data.codiceFiscale);
                $("#via").text(data.via);
                $("#recapito").text(data.recapito);
                $("#matricola").text(data.matricola);
                $("#facolta").text(data.facolta);
                $("#nomeM").append(data.nome);
                $("#cognomeM").append(data.cognome);
                $("#pswM").append(data.password);
                $("#codiceM").append(data.codiceFiscale);
                $("#viaM").append(data.via);
                $("#recapitoM").append(data.recapito);
                $("#facoltaM").append(data.facolta);
            })
        }
        else {
            if (x != undefined) {
                $.get("/user/visualizzaDA?email=" + x, function (data) {
                    $("#nome").text(data.nome);
                    $("#cognome").text(data.cognome);
                    $("#email").text(data.emailCoordinatore);
                    $("#password").text(data.password);
                    $("#codicefiscale").text(data.codiceFiscale);
                    $("#via").text(data.via);
                    $("#recapito").text(data.recapito);
                    $("#matricola").text(data.ruolo);
                    $("#facolta").text(data.facolta);
                    $("#nomeM").append(data.nome);
                    $("#cognomeM").append(data.cognome);
                    $("#pswM").append(data.password);
                    $("#codiceM").append(data.codiceFiscale);
                    $("#viaM").append(data.via);
                    $("#recapitoM").append(data.recapito);
                    $("#facoltaM").append(data.facolta)
                })
            }
        }
    }
    $("#conferma1").click(function () {
        $("#nome").html($("#nomeL").val());
    })
    $("#conferma2").click(function () {
        $("#cognome").html($("#cognomeL").val());
    })
    $("#conferma3").click(function () {
        $("#password").html($("#passwordL").val());
    })
    $("#conferma4").click(function () {
        $("#codicefiscale").html($("#codicefiscaleL").val());
    })
    $("#conferma5").click(function () {
        $("#via").html($("#viaL").val());
    })
    $("#conferma6").click(function () {
        $("#recapito").html($("#recapitoL").val());
    })
    $("#conferma7").click(function () {
        $("#facolta").html($("#facoltaL").val());
    })

    $("#salva").click(function () {
        var x = localStorage.getItem("email");
        var help = $("#nome").val();
        let toUpdate = 
         {
                //sarà l'oggetto che conterrà i dati che saranno modificati
                "nome": $("#nome").html(),
                "cognome": $("#cognome").html(),
                "email": x,
                "password": $("#password").html(),
                "via": $("#via").html(),
                "recapito": $("#recapito").html(),
                "facolta": $("#facolta").html(),
                "codiceFiscale": $("#codicefiscale").html()
        };
        console.log(toUpdate);
        $.ajax({
            method: 'POST',
            data: toUpdate,
            url: 'user/modificaDA/',
            success: function (done) {
                alert("Dati aggiornati!");
                window.location.href = "/visualizzaDatiAccesso.html";
            },
            error: function (e) {
                alert(x);
                alert(JSON.stringify(vecchi));
                window.location.href = "/visualizzaDatiAccesso.html";
            }
        })
    }) 
</script>

</html>